# Reset Microsoft Store Script\n#Requires -Version 5.0\n#Requires -RunAsAdministrator\n\nparam([switch]$Silent, [switch]$CreateBackup = $true, [switch]$Force)\n\n$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Definition\nImport-Module (Join-Path $scriptPath \"ReSetUtils.psm1\") -Force\n\n$operationName = \"Microsoft Store Reset\"\n\ntry {\n    Assert-AdminRights\n    $operation = Start-ReSetOperation -OperationName $operationName\n    \n    # Reset Microsoft Store cache\n    Write-ProgressStep -StepName \"Resetting Store cache\" -CurrentStep 1 -TotalSteps 6\n    try {\n        $null = & wsreset 2>&1\n    } catch {}\n    \n    # Clear Store data\n    Write-ProgressStep -StepName \"Clearing Store data\" -CurrentStep 2 -TotalSteps 6\n    $storeDataPath = \"$env:LocalAppData\\Packages\\Microsoft.WindowsStore_8wekyb3d8bbwe\"\n    if (Test-Path $storeDataPath) {\n        Remove-Item -Path \"$storeDataPath\\LocalCache\\*\" -Recurse -Force -ErrorAction SilentlyContinue\n    }\n    \n    # Reset Store services\n    Write-ProgressStep -StepName \"Resetting Store services\" -CurrentStep 3 -TotalSteps 6\n    $storeServices = @(\"InstallService\", \"LicenseManager\", \"StorSvc\")\n    foreach ($service in $storeServices) {\n        Restart-WindowsService -ServiceName $service\n    }\n    \n    # Re-register Store apps\n    Write-ProgressStep -StepName \"Re-registering Store apps\" -CurrentStep 4 -TotalSteps 6\n    try {\n        Get-AppxPackage -AllUsers | Where-Object {$_.Name -like \"*WindowsStore*\"} | ForEach-Object {Add-AppxPackage -DisableDevelopmentMode -Register \"$($_.InstallLocation)\\AppXManifest.xml\"}\n    } catch {}\n    \n    # Reset Store registry\n    Write-ProgressStep -StepName \"Resetting Store registry\" -CurrentStep 5 -TotalSteps 6\n    $storeRegPath = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Store\"\n    if (Test-Path $storeRegPath) {\n        Remove-RegistryKey -Path $storeRegPath\n    }\n    \n    # Reset app deployment service\n    Write-ProgressStep -StepName \"Resetting app deployment\" -CurrentStep 6 -TotalSteps 6\n    Restart-WindowsService -ServiceName \"AppXSvc\"\n    \n    Write-ReSetLog \"Microsoft Store reset completed successfully\" \"SUCCESS\"\n    Complete-ReSetOperation -OperationInfo $operation -Success $true\n}\ncatch {\n    Complete-ReSetOperation -OperationInfo $operation -Success $false -ErrorMessage $_.Exception.Message\n    throw\n}"