# Reset Input Devices Script\n#Requires -Version 5.0\n#Requires -RunAsAdministrator\n\nparam([switch]$Silent, [switch]$CreateBackup = $true, [switch]$Force)\n\n$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Definition\nImport-Module (Join-Path $scriptPath \"ReSetUtils.psm1\") -Force\n\n$operationName = \"Input Devices Reset\"\n\ntry {\n    Assert-AdminRights\n    $operation = Start-ReSetOperation -OperationName $operationName\n    \n    # Reset mouse settings\n    Write-ProgressStep -StepName \"Resetting mouse settings\" -CurrentStep 1 -TotalSteps 8\n    $mousePath = \"HKCU:\\Control Panel\\Mouse\"\n    Set-RegistryValue -Path $mousePath -Name \"MouseSpeed\" -Value \"1\" -Type String\n    Set-RegistryValue -Path $mousePath -Name \"MouseThreshold1\" -Value \"6\" -Type String\n    Set-RegistryValue -Path $mousePath -Name \"MouseThreshold2\" -Value \"10\" -Type String\n    Set-RegistryValue -Path $mousePath -Name \"SwapMouseButtons\" -Value \"0\" -Type String\n    \n    # Reset keyboard settings\n    Write-ProgressStep -StepName \"Resetting keyboard settings\" -CurrentStep 2 -TotalSteps 8\n    $keyboardPath = \"HKCU:\\Control Panel\\Keyboard\"\n    Set-RegistryValue -Path $keyboardPath -Name \"KeyboardDelay\" -Value \"1\" -Type String\n    Set-RegistryValue -Path $keyboardPath -Name \"KeyboardSpeed\" -Value \"31\" -Type String\n    Set-RegistryValue -Path $keyboardPath -Name \"InitialKeyboardIndicators\" -Value \"2\" -Type String\n    \n    # Reset touchpad settings\n    Write-ProgressStep -StepName \"Resetting touchpad settings\" -CurrentStep 3 -TotalSteps 8\n    $touchpadPath = \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PrecisionTouchPad\"\n    Set-RegistryValue -Path $touchpadPath -Name \"Enabled\" -Value 1 -Type DWord\n    Set-RegistryValue -Path $touchpadPath -Name \"TapToClickEnabled\" -Value 1 -Type DWord\n    \n    # Reset pen and touch settings\n    Write-ProgressStep -StepName \"Resetting pen and touch\" -CurrentStep 4 -TotalSteps 8\n    $penPath = \"HKCU:\\SOFTWARE\\Microsoft\\TabletTip\\1.7\"\n    Set-RegistryValue -Path $penPath -Name \"EnableAutocorrection\" -Value 1 -Type DWord\n    Set-RegistryValue -Path $penPath -Name \"EnableSpellchecking\" -Value 1 -Type DWord\n    \n    # Reset accessibility settings\n    Write-ProgressStep -StepName \"Resetting accessibility settings\" -CurrentStep 5 -TotalSteps 8\n    $accessPath = \"HKCU:\\Control Panel\\Accessibility\"\n    Set-RegistryValue -Path \"$accessPath\\StickyKeys\" -Name \"Flags\" -Value \"510\" -Type String\n    Set-RegistryValue -Path \"$accessPath\\Keyboard Response\" -Name \"Flags\" -Value \"122\" -Type String\n    Set-RegistryValue -Path \"$accessPath\\ToggleKeys\" -Name \"Flags\" -Value \"58\" -Type String\n    \n    # Reset cursor settings\n    Write-ProgressStep -StepName \"Resetting cursor settings\" -CurrentStep 6 -TotalSteps 8\n    $cursorsPath = \"HKCU:\\Control Panel\\Cursors\"\n    Set-RegistryValue -Path $cursorsPath -Name \"\" -Value \"\" -Type String\n    Set-RegistryValue -Path $cursorsPath -Name \"Scheme Source\" -Value 0 -Type DWord\n    \n    # Reset game controller settings\n    Write-ProgressStep -StepName \"Resetting game controllers\" -CurrentStep 7 -TotalSteps 8\n    $gameControllerPath = \"HKCU:\\System\\CurrentControlSet\\Control\\MediaProperties\\PrivateProperties\\Joystick\\OEM\"\n    if (Test-Path $gameControllerPath) {\n        # Reset controller calibration\n    }\n    \n    # Restart input services\n    Write-ProgressStep -StepName \"Restarting input services\" -CurrentStep 8 -TotalSteps 8\n    $inputServices = @(\"TabletInputService\", \"TouchKeyboard\")\n    foreach ($service in $inputServices) {\n        Restart-WindowsService -ServiceName $service\n    }\n    \n    Write-ReSetLog \"Input devices reset completed successfully\" \"SUCCESS\"\n    Complete-ReSetOperation -OperationInfo $operation -Success $true\n}\ncatch {\n    Complete-ReSetOperation -OperationInfo $operation -Success $false -ErrorMessage $_.Exception.Message\n    throw\n}"